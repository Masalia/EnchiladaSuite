# Burrito:

Burrito is a wrapper for the Manhattanizer.R (expansion of Sariel Hubner's original Helimap.v.1 pipeline). This wrapper treats environments and traits individually, producing a Manhattan plot and list of significant SNPs for each trait_environment combination, as determined by a USER specified environments.list and traits.list.

Associations are run through the program EMMAX (Kang et al., 2010), which is an expedited version of the program EMMA (Kang et al., 2008). EMMAX is run with kinship (IBS) and structure (PCA) to reduce spurious associations. Preferences for this wrapper are controlled in the configuration file ("Asada.config").

It’s important to note that “environments” don’t need to be treatments or locations, but can also represent any grouping of phenotype data including the difference/GMP/relative difference...etc between two environments. 

How to run:

In the EnchiladaSuite.pl script the following line is presented:
   
   perl Burrito.pl Environments.list Traits.list
    
The arguments Environments.list and Traits.list are two list files that list the environments your traits exist in. This can be a singular environment or numerous environments. The Traits.list argument is similar but corresponds to phenotypic traits you want to map. Each argument is a separate file in the main Enchilada Suite directory.

To run this module separately without the others, comment out the other modules. 

# Contents in Burrito directory
Files:
1. Asada.config → example Asada.config file
2. XRQ_213.aIBS.kinf → kinship file for the 213 genotypes, as generated through EMMAX
3. XRQ_213.group → group file of all 213 genotypes and what sunflower category they belong with (e.g., HA-oil, RHA-non-oil)
4. XRQ_213.map → “map” file called in the pipeline. Just a list of markers and their position, not generated by plink.
5. XRQ_213.PCA_EV → Structure file
6. XRQ_213.tab → variant of the tped file
7. XRQ_213.tfam → tfam file generated in Plinkv1.9
8. XRQ_213.tped → tped file generated in Plinkv1.9
9. XRQ_213.vcf → VCF file with 640,508 markers and 213 genotypes. Created by Sariel Hubner, heterozygotes convereted to missing data, and filtered for ≤ 30% missing data and ≥5% MAF

#Pheno file format

The format of the phenotype files is  VERY SPECIFIC, and is outlined below.

Every phenotypic trait PER environment gets a separate file. The files need to be named as following:
Trait_Environment.txt
  
Trait names  CANNOT  contain spaces, commas, or underscores (“_”), but may contain periods to denote spacing. This also applies to Environment names.

The format per file is two columns separated by a tab, the first is “Line” which lists PPNs grown under the experimental condition, and the second column is “Value” which lists a value associated with that line. These values can be averaged values across replicates, or preferably LSmeans accounting for the design of each experiment.

Examples of this are provided in the “Phenos”, please delete or move the phenos files prior to running your own data. The headers “Line” and “Value” are case sensitive, as are the “PPN###.” Once you have your phenotype data formated correctly, place  ALL  phenotype data for all traits and environments into the “Phenos” directory in the main Enchilada Suite directory.

#Asada configuration file and flags:
1. Colors for Manhattan plots → these are R colors for alternating chromosomes, the defaults are “red” and “blue”

#Outputs:

There are three outputs per trait_environment.

1. Trait_Environment.ps → this is the EMMAX output and should have FOUR columns of information. The marker \t the beta value \t the standard error of beta \t and finally the p-value.

2. Trait_Environment.sigsnps → this is a table that lists ALL snps above the Bonferroni Correction (P ≤ 5.6E-07 at ɑ = 0.05)

2a. If there are NO significant SNPs about the Bonferroni threshold, your sigsnps file will say “There are no significant SNPs in this trait in this environment.” A plot will still be produced.

3. Trait_Environment.pdf → these are PDF Manhattan plots, and are stashed in the “Outputs/Plots/ManhattanPlots” folder. Further, to make the plotting and loading faster, SNPs with a LOD score < 2.0 are not shown. The red line = Bonferroni threshold
